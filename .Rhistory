WikiData3$X5 <- DenominatorNew
head(WikiData3)
head(WikiData3[100:150,])
WikiData3[100:150,]
WikiData3 <- data.frame(matrix(NA, nrow = length(CorrectRows), ncol = 2))
NewRow <- 1
for(i in CorrectRows){
WikiData3[NewRow, ] <- WikiData2[i, c(1, 3)]
NewRow <- NewRow + 1
}
SplitVotesClean <- unlist(strsplit(WikiData2[c(1:105, 110, 112, 114:115, 117:118, 123:218), 7], split = '/'))
NumeratorClean <- SplitVotesClean[seq(1,length(SplitVotesClean), 2)]
DenominatorClean <- SplitVotesClean[seq(2, length(SplitVotesClean), 2)]
NumeratorDirty <- unlist(strsplit(WikiData2[c(106:109, 111, 113, 116, 119:122), 7], split = '/ 352'))
DenominatorDirty <- rep('352', length(NumeratorDirty))
NumeratorNew <- c(NumeratorClean[1:105], NumeratorDirty[1:8],
NumeratorClean[106], NumeratorDirty[9:10],
NumeratorClean[107], NumeratorDirty[11:12],
NumeratorClean[108:109], NumeratorDirty[13:14],
NumeratorClean[110:111], NumeratorDirty[15:22],
NumeratorClean[112:length(NumeratorClean)])
DenominatorNew <- c(DenominatorClean[1:105], DenominatorDirty[1:8],
DenominatorClean[106], DenominatorDirty[9:10],
DenominatorClean[107], DenominatorDirty[11:12],
DenominatorClean[108:109], DenominatorDirty[13:14],
DenominatorClean[110:111], DenominatorDirty[15:22],
DenominatorClean[112:length(DenominatorClean)])
WikiData3$X3 <- NumeratorNew
WikiData3$X4 <- DenominatorNew
head(WikiData3)
colnames(WikiData3) <- c('Year', 'Candidate', 'Votes', 'Total')
aggregate(WikiData3[, 3] ~ WikiData3[, 1] + WikiData3[, 2], FUN = sum)
aggregate(as.numeric(WikiData3[, 3]) ~ WikiData3[, 1] + WikiData3[, 2], FUN = sum)
aggregate(as.numeric(WikiData3[, 3]) ~ WikiData3[, 1] + WikiData3[, 2] + WikiData3[, 3], FUN = sum)
aggregate(as.numeric(WikiData3[, 3]) ~ WikiData3[, 1] + WikiData3[, 2] + WikiData3[, 4], FUN = sum)
WikiData3 <- aggregate(as.numeric(WikiData3[, 3]) ~ WikiData3[, 1] + WikiData3[, 2] + WikiData3[, 4], FUN = sum)
colnames(WikiData3) <- c('Year', 'Candidate', 'Votes', 'Total')
head(WikiData3)
WikiData3[,1:3]
test <- head(merge(x = WikiData, y = WikiData3[,1:3],
by.x = c('Winner...party', 'Election.1'),
by.y = c('Candidate', 'Year')))
head(test)
test2 <- head(merge(x = test, y = WikiData3[, 1:3],
by.x = c('Runner.up...party', 'Election.1'),
by.y = c('Candidate', 'Year')))
head(test2)
head(WikiData3)
WikiData2 <- htmltab(wikiURL2, which = 3)
CorrectRows <- c(1:105, 106, 106, 107, 107, 108, 108, 109, 109, 110, 111, 111,
112, 113, 113, 114:115, 116, 116, 117:118, 119, 119, 120, 120,
121, 121, 122, 122, 123:218)
WikiData3 <- data.frame(matrix(NA, nrow = length(CorrectRows), ncol = 2))
NewRow <- 1
for(i in CorrectRows){
WikiData3[NewRow, ] <- WikiData2[i, c(1, 3)]
NewRow <- NewRow + 1
}
SplitVotesClean <- unlist(strsplit(WikiData2[c(1:105, 110, 112, 114:115, 117:118, 123:218), 7], split = '/'))
NumeratorClean <- SplitVotesClean[seq(1,length(SplitVotesClean), 2)]
DenominatorClean <- SplitVotesClean[seq(2, length(SplitVotesClean), 2)]
NumeratorDirty <- unlist(strsplit(WikiData2[c(106:109, 111, 113, 116, 119:122), 7], split = '/ 352'))
DenominatorDirty <- rep('352', length(NumeratorDirty))
NumeratorNew <- c(NumeratorClean[1:105], NumeratorDirty[1:8],
NumeratorClean[106], NumeratorDirty[9:10],
NumeratorClean[107], NumeratorDirty[11:12],
NumeratorClean[108:109], NumeratorDirty[13:14],
NumeratorClean[110:111], NumeratorDirty[15:22],
NumeratorClean[112:length(NumeratorClean)])
DenominatorNew <- c(DenominatorClean[1:105], DenominatorDirty[1:8],
DenominatorClean[106], DenominatorDirty[9:10],
DenominatorClean[107], DenominatorDirty[11:12],
DenominatorClean[108:109], DenominatorDirty[13:14],
DenominatorClean[110:111], DenominatorDirty[15:22],
DenominatorClean[112:length(DenominatorClean)])
WikiData3$X3 <- NumeratorNew
WikiData3$X4 <- DenominatorNew
WikiData3 <- aggregate(as.numeric(WikiData3[, 3]) ~ WikiData3[, 1] + WikiData3[, 2] + WikiData3[, 4], FUN = sum)
head(WikiData3)
colnames(WikiData3) <- c('Year', 'Candidate', 'Total', 'Votes')
test <- head(merge(x = WikiData, y = WikiData3[, c(1, 2, 4)],
by.x = c('Winner...party', 'Election.1'),
by.y = c('Candidate', 'Year')))
head(test)
test2 <- head(merge(x = test, y = WikiData3[, c(1, 2, 4)],
by.x = c('Runner.up...party', 'Election.1'),
by.y = c('Candidate', 'Year')))
head(test2)
wikiURL2 <- 'https://en.wikipedia.org/wiki/United_States_presidential_election'
temp <- wikiURL2 %>%
read_html %>%
html_nodes("table")
library(htmltab)
WikiData2 <- htmltab(wikiURL2, which = 3)
WikiData2[, 7]
grep('^(\d+)', '', WikiData2[, 7])
gregexpr('^(\d+)', '', WikiData2[, 7])
gregexpr('^(:digit:)', '', WikiData2[, 7])
grep('^(:digit:)', '', WikiData2[, 7])
gsub('^(:digit:)', '', WikiData2[, 7])
gsub( " .*$", "", WikiData2[, 7])
WikiData2 <- htmltab(wikiURL2, which = 3)
WikiData2[, 7] <- gsub( " .*$", "", WikiData2[, 7])
head(WikiData2)
WikiData2[,7]
WikiData2[116,]
WikiData2[106,]
WikiData2[106:110,]
WikiData2[106:115,]
WikiData2[105:115,]
WikiData2[106, 7]
WikiData2[106, 7] <- '42'
WikiData[105:107,]
WikiData2 <- htmltab(wikiURL2, which = 3)
WikiData2[, 7]
WikiData2[, 7] <- gsub( " .*$", "", WikiData2[, 7])
WikiData2[,7]
class(WikiData2[,7])
class(WikiData2[1,7])
WikiData2[1,7]
WikiData2[106, 7]
WikiData2[106, 7] <- '42'
WikiData2[106, 7]
head(WikiData2)
head(WikiData2[106:107,])
test <- head(merge(x = WikiData, y = WikiData2[, c(1, 2, 4)],
by.x = c('Winner...party', 'Election.1'),
by.y = c('Presidential candidate', 'Year')))
test <- head(merge(x = WikiData, y = WikiData2[, c(1, 2, 7)],
by.x = c('Winner...party', 'Election.1'),
by.y = c('Presidential candidate', 'Year')))
head(WikiData2)
test <- head(merge(x = WikiData, y = WikiData2[, c(1, 2, 7)],
by.x = c('Winner...party', 'Election.1'),
by.y = c('Presidential candidate', 'Year')))
WikiData2[, c(1, 2, 7)]
class(WikiData$Election.1)
class(WikiData2$Year)
merge(x = WikiData, y = WikiData2[, c(1, 2, 7)],
by.x = c('Winner...party', 'Election.1'),
by.y = c('Presidential candidate', 'Year'))
wikiURL <- 'https://en.wikipedia.org/wiki/List_of_United_States_presidential_elections_by_popular_vote_margin'
temp <- wikiURL %>%
read_html %>%
html_nodes("table")
WikiData <- html_table(temp[2])
WikiData <- as.data.frame(WikiData)[-(1:2),]
WikiData <- apply(WikiData, 2, function(x) gsub('\\[a\\]', '', x))
WikiData <- apply(WikiData, 2, function(x) gsub('\\%', '', x))
WikiData[, c(1, 2, 6, 7, 8, 9, 10, 13)] <- apply(WikiData[, c(1, 2, 6, 7, 8, 9, 10, 13)],
2, function(x) gsub(',', '', x))
WikiData[, c(1, 2, 6, 7, 8, 9, 10, 13)] <- apply(WikiData[, c(1, 2, 6, 7, 8, 9, 10, 13)],
2, function(x) gsub('−', '-', x))
WikiData <- as.data.frame(WikiData)
WikiData <- WikiData[order(WikiData$Election), ]
WikiData[, c(3, 11)] <- apply(WikiData[, c(3, 11)], 2,
function(x) gsub('^(.+?),', '', x))
PointColors <- as.character(WikiData$Winner...party.1)
PointColors[PointColors == 'Dem.'] <- 'blue'
PointColors[PointColors == 'Rep.'] <- 'red'
PointColors[PointColors == 'Whig'] <- 'yellow'
PointColors[PointColors == 'D.-R.'] <- 'green'
wikiURL2 <- 'https://en.wikipedia.org/wiki/United_States_presidential_election'
library(htmltab)
WikiData2 <- htmltab(wikiURL2, which = 3)
WikiData2[, 7] <- gsub( " .*$", "", WikiData2[, 7])
WikiData2[106, 7] <- '42'
head(WikiData2)
head(WikiData)
test <- head(merge(x = WikiData, y = WikiData2[, c(1, 2, 7)],
by.x = c('Winner...party', 'Election.1'),
by.y = c('Presidential candidate', 'Year')))
WikiData2[, c(1, 2, 7)]
test <- head(merge(x = WikiData, y = WikiData2[, c(1, 2, 7)],
by.x = c('Winner...party', 'Election.1'),
by.y = c(1,2)))
head(test)
head(merge(x = WikiData, y = WikiData2[, c(1, 2, 7)],
by.x = c('Winner...party', 'Election.1'),
by.y = c('Year')))
head(merge(x = WikiData, y = WikiData2[, c(1, 2, 7)],
by.x = c('Election.1'),
by.y = c('Year')))
WikiData2[, c(1, 2, 7)]
WikiData2
head(merge(x = WikiData, y = WikiData2[, c(1, 3, 7)],
by.x = c('Election.1', 'Winner...party'),
by.y = c('Year', 'Presidential candidate')))
WikiData
WikiData2[, c(1, 3, 7)]
head(merge(x = WikiData, y = WikiData2[, c(1, 3, 7)],
by.x = c('Election.1', 'Winner...party'),
by.y = c('Year', 'Presidential candidate')))
WikiData2[WikiData2$Year == '1824',]
WikiData2 <- aggregate(as.numeric(WikiData2[, 7]) ~ WikiData2[, 1] + WikiData2[, 3], FUN = sum)
head(WikiData2)
test <- head(merge(x = WikiData, y = WikiData2[, c(1, 3, 7)],
by.x = c('Election.1', 'Winner...party'),
by.y = c('Year', 'Presidential candidate')))
test <- head(merge(x = WikiData, y = WikiData2,
by.x = c('Election.1', 'Winner...party'),
by.y = c(1, 2)))
test
test[,c(1,14)]
test[,c(5,14)]
test <- merge(x = WikiData, y = WikiData2,
by.x = c('Election.1', 'Winner...party'),
by.y = c(1, 2))
test[,c(5,14)]
test2 <- head(merge(x = test, y = WikiData2,
by.x = c('Runner.up...party', 'Election.1'),
by.y = c(1, 2)))
head(test2)
head(test)
WikiData2
test2 <- merge(x = test, y = WikiData2,
by.x = c('Runner.up...party', 'Election.1'),
by.y = c(1, 2))
test2
test <- merge(x = WikiData, y = WikiData2,
by.x = c('Election.1', 'Winner...party'),
by.y = c(1, 2))
test
test$Runner.up...party
test$Election.1
WikiData2[,1:2]
merge(x = test, y = WikiData2,
by.x = c('Runner.up...party', 'Election.1'),
by.y = c(1, 2))
WikiData2[,3]
test2 <- merge(x = WikiData, y = WikiData2,
by.x = c('Runner.up...party', 'Election.1'),
by.y = c(1, 2))
test2
test2 <- merge(x = WikiData, y = WikiData2,
by.x = c('Election.1', 'Runner.up...party'),
by.y = c(1, 2))
test2
test <- merge(x = WikiData, y = WikiData2,
by.x = c('Election.1', 'Winner...party'),
by.y = c(1, 2))
test
test2 <- merge(x = test, y = WikiData2,
by.x = c('Election.1', 'Runner.up...party'),
by.y = c(1, 2))
head(test2)
test2[, c(1, 3, 14, 2, 15)]
WikiData
WikiData2
sort(WikiData2[,1])
test[,1]
WikiData[WikiData[,1] == '1868']
WikiData[WikiData[,2] == '1868']
WikiData[WikiData[,2] == '1868',]
head(WikiData)
WikiData2[WikiData2 == '1868', ]
head(WikiData)
WikiData2[, 7] <- gsub( " .*$", "", WikiData2[, 7])
WikiData2[106, 7] <- '42'
WikiData2 <- aggregate(as.numeric(WikiData2[, 7]) ~ WikiData2[, 1] + WikiData2[, 3], FUN = sum)
WikiData2 <- htmltab(wikiURL2, which = 3)
WikiData2[, 7] <- gsub( " .*$", "", WikiData2[, 7])
WikiData2[106, 7] <- '42'
WikiData2 <- aggregate(as.numeric(WikiData2[, 7]) ~ WikiData2[, 1] + WikiData2[, 3], FUN = sum)
head(WikiData2)
colnames(WikiData2) <- c('Year', 'Candidate', 'Votes')
WikiData[,3]
WikiData[,7]
WikiData[,1:8]
WikiData[,9:12]
WikiData[,c(3,11)]
strsplit(WikiData[ ,3], split=" ")
strsplit(WikiData[ ,3], split=" ")[[1]]
tail(strsplit(WikiData[ ,3], split=" "), 1)
tail(strsplit(WikiData[ ,3], split=" ")[[1]], 1)
tail(strsplit(WikiData[ , c(3,11)], split=" ")[[1]], 1)
WikiData[,c(3,11)]
class(WikiData[,3])
class(WikiData[,11])
WikiData[ , c(3,11)]
apply(WikiData[ , c(3, 11)], 2,
function(x) tail(strsplit(x, split=" ")[[1]], 1)
# PLOTTING
PointColors <- as.character(WikiData$Winner...party.1)
PointColors[PointColors == 'Dem.'] <- 'blue'
PointColors[PointColors == 'Rep.'] <- 'red'
PointColors[PointColors == 'Whig'] <- 'yellow'
PointColors[PointColors == 'D.-R.'] <- 'green'
plot(x = as.numeric(WikiData$Election), y = as.numeric(WikiData$Popular.vote),
type = 'l', ylim = c(0,100), lty = 1, col = 'blue')
abline(v = 21)
lines(x = WikiData$Election, y = WikiData$Electoral.College.1, lty = 2, col = 'red')
lines(x = WikiData$Election, y = WikiData$Turnout.2., lty = 3, col = 'green')
plot(x = as.numeric(WikiData$Popular.vote),
y = as.numeric(WikiData$Electoral.College.1),
col = PointColors, pch = 19)
plot(x = as.numeric(WikiData$Election),
y = as.numeric(WikiData$Popular.vote),
col = PointColors, pch = 19)
# MERGING
wikiURL <- 'https://en.wikipedia.org/wiki/United_States_presidential_election'
WikiData2 <- htmltab(wikiURL2, which = 3)
WikiData2[, 7] <- gsub( " .*$", "", WikiData2[, 7])
WikiData2[106, 7] <- '42'
WikiData2 <- aggregate(as.numeric(WikiData2[, 7]) ~ WikiData2[, 1] + WikiData2[, 3], FUN = sum)
colnames(WikiData2) <- c('Year', 'Candidate', 'Votes')
test <- merge(x = WikiData, y = WikiData2,
by.x = c('Election.1', 'Winner...party'),
by.y = c(1, 2))
test2 <- merge(x = test, y = WikiData2,
by.x = c('Election.1', 'Runner.up...party'),
by.y = c(1, 2))
test2[, c(1, 3, 14, 2, 15)]
apply(WikiData[ , c(3, 11)], 2,
function(x) tail(strsplit(x, split=" ")[[1]], 1))
apply(WikiData[ , c(3, 11)], 2,
function(x) strsplit(x, split=" "))
apply(WikiData[ , c(3, 11)], 2,
function(x) tail(strsplit(x, split=" "), 1)
# PLOTTING
PointColors <- as.character(WikiData$Winner...party.1)
PointColors[PointColors == 'Dem.'] <- 'blue'
PointColors[PointColors == 'Rep.'] <- 'red'
PointColors[PointColors == 'Whig'] <- 'yellow'
PointColors[PointColors == 'D.-R.'] <- 'green'
plot(x = as.numeric(WikiData$Election), y = as.numeric(WikiData$Popular.vote),
type = 'l', ylim = c(0,100), lty = 1, col = 'blue')
abline(v = 21)
lines(x = WikiData$Election, y = WikiData$Electoral.College.1, lty = 2, col = 'red')
lines(x = WikiData$Election, y = WikiData$Turnout.2., lty = 3, col = 'green')
plot(x = as.numeric(WikiData$Popular.vote),
y = as.numeric(WikiData$Electoral.College.1),
col = PointColors, pch = 19)
plot(x = as.numeric(WikiData$Election),
y = as.numeric(WikiData$Popular.vote),
col = PointColors, pch = 19)
# MERGING
wikiURL <- 'https://en.wikipedia.org/wiki/United_States_presidential_election'
WikiData2 <- htmltab(wikiURL2, which = 3)
WikiData2[, 7] <- gsub( " .*$", "", WikiData2[, 7])
WikiData2[106, 7] <- '42'
WikiData2 <- aggregate(as.numeric(WikiData2[, 7]) ~ WikiData2[, 1] + WikiData2[, 3], FUN = sum)
colnames(WikiData2) <- c('Year', 'Candidate', 'Votes')
test <- merge(x = WikiData, y = WikiData2,
by.x = c('Election.1', 'Winner...party'),
by.y = c(1, 2))
test2 <- merge(x = test, y = WikiData2,
by.x = c('Election.1', 'Runner.up...party'),
by.y = c(1, 2))
test2[, c(1, 3, 14, 2, 15)]
apply(WikiData[ , c(3, 11)], 2,
function(x) tail(strsplit(x, split=" "), 1))
apply(WikiData[ , c(3, 11)], 2,
function(x) tail(strsplit(x, split=" ")[[1]], 1))
apply(1:nrow(WikiData), 2,
function(x) tail(strsplit(WikiData[ , c(3, 11)],
split=" ")[[x]], 1))
WikiData[,c(3,11)]
apply(1:nrow(WikiData), 2,
function(x) tail(strsplit(WikiData[ , c(3, 11)],
split=" ")[[x]], 1))
apply(WikiData[ , c(3, 11)], 2,
function(x) tail(strsplit(x, split=" ")[[1]], 1))
apply(WikiData[ , c(3, 11)], 2,
function(x) tail(strsplit(x, split=" ")[[2]], 1))
apply(WikiData[ , c(3, 11)], 2,
function(x) tail(strsplit(x, split=" ")[[1:2]], 1))
apply(WikiData[ , c(3, 11)], 2,
function(x) tail(strsplit(x, split=" ")[[4:5]], 1))
apply(WikiData[ , c(3, 11)], 2,
function(x) tail(strsplit(x, split=" ")[[4]], 1))
apply(WikiData[ , c(3, 11)], 2,
function(x) tail(strsplit(x, split=" ")[[5]], 1))
strsplit(WikiData[ , c(3, 11)], split = ' ')
strsplit(WikiData[ , c(3)], split = ' ')
unlist(strsplit(WikiData[ , c(3)], split = ' '))
lapply(strsplit(WikiData[ , c(3)], split = ' ')), function(x) tail(x, 1))
lapply(strsplit(WikiData[ , c(3)], split = ' '), function(x) tail(x, 1))
lapply(strsplit(WikiData[ , c(3)], split = ' '), function(x) tail(x, 1))
unlist(lapply(strsplit(WikiData[ , c(3)], split = ' '), function(x) tail(x, 1)))
unlist(lapply(strsplit(WikiData[ , 3], split = ' '), function(x) tail(x, 1)))
unlist(lapply(strsplit(WikiData[ , 11], split = ' '), function(x) tail(x, 1)))
WikiData$WinLast <- unlist(lapply(strsplit(WikiData[ , 3], split = ' '),
function(x) tail(x, 1)))
WikiData$RunLast <- unlist(lapply(strsplit(WikiData[ , 11], split = ' '),
function(x) tail(x, 1)))
cbind(WikiData$WinLast, WikiData$RunLast)
head(WikiData2)
WikiData2$CandLast <- unlist(lapply(strsplit(WikiData2$Candidate, split = ' '),
function(x) tail(x, 1)))
WikiData2$CandLast
head(test)
head(WikiData)
head(WikiData2)
test <- merge(x = WikiData, y = WikiData2,
by.x = c('Election.1', 'WinLast'),
by.y = c('Year', 'CandLast'))
test
test2 <- merge(x = test, y = WikiData2,
by.x = c('Election.1', 'Runner.up...party'),
by.y = c('Year', 'CandLast'))
dim(test2)
test2
test2 <- merge(x = test, y = WikiData2,
by.x = c('Election.1', 'RunLast'),
by.y = c('Year', 'CandLast'))
dim(test2)
dim(WikiData)
head(test2)
test2$Election.1
WikiData[WikiData$Election.1 == '1952' & WikiData$Election.1 == '1956', ]
WikiData[WikiData$Election.1 == '1952' | WikiData$Election.1 == '1956', ]
WikiData2[WikiData2$Year == '1952' | WikiData2$Year == '1956', ]
WikiData[WikiData$CandLast == 'II',]
WikiData2[WikiData2$CandLast == 'II',]
WikiData2[WikiData2$CandLast == 'II', WikiData2$CandLast] <- 'Stevenson'
WikiData2[WikiData2$CandLast == 'II', WikiData2$CandLast]
WikiData2[WikiData2$CandLast == 'II', ]
WikiData2[WikiData2$CandLast == 'II', 'CandLast']
WikiData2[WikiData2$CandLast == 'II', 'CandLast'] <- 'Stevenson'
WikiData2[WikiData2$CandLast == 'II', 'CandLast']
WikiData2[WikiData2$CandLast == 'II', 'CandLast'] <- rep('Stevenson', 2)
WikiData2[WikiData2$CandLast == 'II', 'CandLast']
wikiURL <- 'https://en.wikipedia.org/wiki/United_States_presidential_election'
WikiData2 <- htmltab(wikiURL2, which = 3)
WikiData2[, 7] <- gsub( " .*$", "", WikiData2[, 7])
WikiData2[106, 7] <- '42'
WikiData2 <- aggregate(as.numeric(WikiData2[, 7]) ~ WikiData2[, 1] + WikiData2[, 3], FUN = sum)
colnames(WikiData2) <- c('Year', 'Candidate', 'Votes')
WikiData2$CandLast <- unlist(lapply(strsplit(WikiData2$Candidate, split = ' '),
function(x) tail(x, 1)))
WikiData2[WikiData2$CandLast == 'II', 'CandLast']
WikiData2[WikiData2$CandLast == 'II', 'CandLast'] <- rep('Stevenson', 2)
WikiData2[WikiData2$CandLast == 'II', 'CandLast']
test <- merge(x = WikiData, y = WikiData2,
by.x = c('Election.1', 'WinLast'),
by.y = c('Year', 'CandLast'))
test2 <- merge(x = test, y = WikiData2,
by.x = c('Election.1', 'RunLast'),
by.y = c('Year', 'CandLast'))
dim(test2)
dim(WikiData)
library(rvest)
library(htmltab)
wikiURL <- 'https://en.wikipedia.org/wiki/List_of_United_States_presidential_elections_by_popular_vote_margin'
#temp <- wikiURL %>%
#  read_html %>%
#  html_nodes("table")
WikiData <- html_table(temp[2])
WikiData <- as.data.frame(WikiData)[-(1:2),]
WikiData <- apply(WikiData, 2, function(x) gsub('\\[a\\]', '', x))
WikiData <- apply(WikiData, 2, function(x) gsub('\\%', '', x))
WikiData[, c(1, 2, 6, 7, 8, 9, 10, 13)] <- apply(WikiData[, c(1, 2, 6, 7, 8, 9, 10, 13)],
2, function(x) gsub(',', '', x))
WikiData[, c(1, 2, 6, 7, 8, 9, 10, 13)] <- apply(WikiData[, c(1, 2, 6, 7, 8, 9, 10, 13)],
2, function(x) gsub('−', '-', x))
WikiData <- as.data.frame(WikiData)
WikiData <- WikiData[order(WikiData$Election), ]
WikiData[, c(3, 11)] <- apply(WikiData[, c(3, 11)], 2,
function(x) gsub('^(.+?),', '', x))
WikiData$WinLast <- unlist(lapply(strsplit(WikiData[ , 3], split = ' '),
function(x) tail(x, 1)))
WikiData$RunLast <- unlist(lapply(strsplit(WikiData[ , 11], split = ' '),
function(x) tail(x, 1)))
library(rvest)
library(htmltab)
wikiURL <- 'https://en.wikipedia.org/wiki/List_of_United_States_presidential_elections_by_popular_vote_margin'
temp <- wikiURL %>%
read_html %>%
html_nodes("table")
WikiData <- html_table(temp[2])
WikiData <- as.data.frame(WikiData)[-(1:2),]
WikiData <- apply(WikiData, 2, function(x) gsub('\\[a\\]', '', x))
WikiData <- apply(WikiData, 2, function(x) gsub('\\%', '', x))
WikiData[, c(1, 2, 6, 7, 8, 9, 10, 13)] <- apply(WikiData[, c(1, 2, 6, 7, 8, 9, 10, 13)],
2, function(x) gsub(',', '', x))
WikiData[, c(1, 2, 6, 7, 8, 9, 10, 13)] <- apply(WikiData[, c(1, 2, 6, 7, 8, 9, 10, 13)],
2, function(x) gsub('−', '-', x))
WikiData <- as.data.frame(WikiData)
WikiData <- WikiData[order(WikiData$Election), ]
WikiData[, c(3, 11)] <- apply(WikiData[, c(3, 11)], 2,
function(x) gsub('^(.+?),', '', x))
WikiData$WinLast <- unlist(lapply(strsplit(WikiData[ , 3], split = ' '),
function(x) tail(x, 1)))
WikiData$RunLast <- unlist(lapply(strsplit(WikiData[ , 11], split = ' '),
function(x) tail(x, 1)))
wikiURL <- 'https://en.wikipedia.org/wiki/United_States_presidential_election'
WikiData2 <- htmltab(wikiURL, which = 3)
WikiData2[, 7] <- gsub( " .*$", "", WikiData2[, 7])
WikiData2[106, 7] <- '42'
WikiData2 <- aggregate(as.numeric(WikiData2[, 7]) ~ WikiData2[, 1] + WikiData2[, 3], FUN = sum)
colnames(WikiData2) <- c('Year', 'Candidate', 'Votes')
WikiData2$CandLast <- unlist(lapply(strsplit(WikiData2$Candidate, split = ' '),
function(x) tail(x, 1)))
WikiData2[WikiData2$CandLast == 'II', 'CandLast'] <- rep('Stevenson', 2)
MergeWinners <- merge(x = WikiData, y = WikiData2,
by.x = c('Election.1', 'WinLast'),
by.y = c('Year', 'CandLast'))
MergedData <- merge(x = MergeWinners, y = WikiData2,
by.x = c('Election.1', 'RunLast'),
by.y = c('Year', 'CandLast'))
dim(MergedData)
MergedData[1,]
WikiData2[1,]
MergeWinners <- merge(x = WikiData, y = WikiData2[,c(1,3,4)],
by.x = c('Election.1', 'WinLast'),
by.y = c('Year', 'CandLast'))
MergedData <- merge(x = MergeWinners, y = WikiData2[,c(1,3,4)],
by.x = c('Election.1', 'RunLast'),
by.y = c('Year', 'CandLast'))
MergedData[1,]
MergedData[, c(16, 17)]
